<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Angular Websocket by angular-class</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Angular Websocket</h1>
      <h2 class="project-tagline">WebSocket service for Angular.js</h2>
      <a href="https://github.com/angular-class/angular-websocket" class="btn">View on GitHub</a>
      <a href="https://github.com/angular-class/angular-websocket/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/angular-class/angular-websocket/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p align="center">
  <a href="https://angularclass.com" target="_blank">
    <img src="https://cloud.githubusercontent.com/assets/1016365/10355203/f50e880c-6d1d-11e5-8f59-d0d8c0870739.png" alt="Angular Websocket" width="500" height="320">
  </a>
</p>

<h1>
<a id="angular-websocket---" class="anchor" href="#angular-websocket---" aria-hidden="true"><span class="octicon octicon-link"></span></a>Angular Websocket  <a href="https://gitter.im/gdi2290/angular-websocket?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://badges.gitter.im/Join%20Chat.svg" alt="Join the chat at https://gitter.im/gdi2290/angular-websocket"></a> <a href="https://www.omniref.com/github/gdi2290/angular-websocket"><img src="https://www.omniref.com/github/gdi2290/angular-websocket.png" alt="gdi2290/angular-websocket API Documentation"></a>
</h1>

<p><a href="https://travis-ci.org/gdi2290/angular-websocket"><img src="https://img.shields.io/travis/gdi2290/angular-websocket.svg?style=flat" alt="Travis"></a>
<a href="https://github.com/gdi2290/angular-websocket"><img src="https://img.shields.io/bower/v/angular-websocket.svg?style=flat" alt="Bower"></a>
<a href="https://www.npmjs.com/package/angular-websocket"><img src="https://img.shields.io/npm/v/angular-websocket.svg?style=flat" alt="npm"></a>
<a href="https://david-dm.org/gdi2290/angular-websocket"><img src="https://david-dm.org/gdi2290/angular-websocket.svg" alt="Dependency Status"></a>
<a href="https://david-dm.org/gdi2290/angular-websocket#info=devDependencies"><img src="https://david-dm.org/gdi2290/angular-websocket/dev-status.svg" alt="devDependency Status"></a>
<a href="https://nodei.co/npm/angular-websocket/"><img src="https://nodei.co/npm/angular-websocket.svg?downloads=true&amp;downloadRank=true&amp;stars=true" alt="NPM"></a></p>

<h3>
<a id="status-looking-for-feedback-about-new-api-changes" class="anchor" href="#status-looking-for-feedback-about-new-api-changes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Status: Looking for feedback about new API changes</h3>

<p>An AngularJS 1.x WebSocket service for connecting client applications to servers.</p>

<h2>
<a id="how-do-i-add-this-to-my-project" class="anchor" href="#how-do-i-add-this-to-my-project" aria-hidden="true"><span class="octicon octicon-link"></span></a>How do I add this to my project?</h2>

<p>You can download angular-websocket by:</p>

<ul>
<li>(prefered) Using bower and running <code>bower install angular-websocket --save</code>
</li>
<li>Using npm and running <code>npm install angular-websocket --save</code>
</li>
<li>Downloading it manually by clicking <a href="https://raw.github.com/gdi2290/angular-websocket/master/angular-websocket.js">here to download development unminified version</a>
</li>
<li>CDN for development <code>https://rawgit.com/gdi2290/angular-websocket/v1.0.9/angular-websocket.js</code>
</li>
<li>CDN for production <code>https://cdn.rawgit.com/gdi2290/angular-websocket/v1.0.9/angular-websocket.min.js</code>
</li>
</ul>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<div class="highlight highlight-text-html-basic"><pre><span class="pl-s1">  &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>http://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">  &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>bower_components/angular-websocket/angular-websocket.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
  &lt;<span class="pl-ent">section</span> <span class="pl-e">ng-controller</span>=<span class="pl-s"><span class="pl-pds">"</span>SomeController<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">ul</span>&gt;
      &lt;<span class="pl-ent">li</span> <span class="pl-e">ng-repeat</span>=<span class="pl-s"><span class="pl-pds">"</span>data in MyData.collection track by $index<span class="pl-pds">"</span></span>&gt;
        {{ data }}
      &lt;/<span class="pl-ent">li</span>&gt;
    &lt;/<span class="pl-ent">ul</span>&gt;
  &lt;/<span class="pl-ent">section</span>&gt;
<span class="pl-s1">  &lt;<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">    angular.module(<span class="pl-s"><span class="pl-pds">'</span>YOUR_APP<span class="pl-pds">'</span></span>, [</span>
<span class="pl-s1">      <span class="pl-s"><span class="pl-pds">'</span>ngWebSocket<span class="pl-pds">'</span></span> <span class="pl-c">// you may also use 'angular-websocket' if you prefer</span></span>
<span class="pl-s1">    ])</span>
<span class="pl-s1">    <span class="pl-c">//                          WebSocket works as well</span></span>
<span class="pl-s1">    .factory(<span class="pl-s"><span class="pl-pds">'</span>MyData<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">$websocket</span>) {</span>
<span class="pl-s1">      <span class="pl-c">// Open a WebSocket connection</span></span>
<span class="pl-s1">      <span class="pl-k">var</span> dataStream <span class="pl-k">=</span> $websocket(<span class="pl-s"><span class="pl-pds">'</span>wss://website.com/data<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1">      <span class="pl-k">var</span> collection <span class="pl-k">=</span> [];</span>
<span class="pl-s1"></span>
<span class="pl-s1">      dataStream.onMessage(<span class="pl-k">function</span>(<span class="pl-smi">message</span>) {</span>
<span class="pl-s1">        collection.<span class="pl-c1">push</span>(<span class="pl-c1">JSON</span>.<span class="pl-c1">parse</span>(message.<span class="pl-c1">data</span>));</span>
<span class="pl-s1">      });</span>
<span class="pl-s1"></span>
<span class="pl-s1">      <span class="pl-k">var</span> methods <span class="pl-k">=</span> {</span>
<span class="pl-s1">        collection<span class="pl-k">:</span> collection,</span>
<span class="pl-s1">        <span class="pl-en">get</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {</span>
<span class="pl-s1">          dataStream.<span class="pl-c1">send</span>(<span class="pl-c1">JSON</span>.stringify({ action<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>get<span class="pl-pds">'</span></span> }));</span>
<span class="pl-s1">        }</span>
<span class="pl-s1">      };</span>
<span class="pl-s1"></span>
<span class="pl-s1">      <span class="pl-k">return</span> methods;</span>
<span class="pl-s1">    })</span>
<span class="pl-s1">    .controller(<span class="pl-s"><span class="pl-pds">'</span>SomeController<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">$scope</span>, <span class="pl-smi">MyData</span>) {</span>
<span class="pl-s1">      $scope.MyData <span class="pl-k">=</span> MyData;</span>
<span class="pl-s1">    });</span>
<span class="pl-s1">  &lt;/<span class="pl-ent">script</span>&gt;</span></pre></div>

<h2>
<a id="api" class="anchor" href="#api" aria-hidden="true"><span class="octicon octicon-link"></span></a>API</h2>

<h3>
<a id="factory-websocket-in-module-ngwebsocket" class="anchor" href="#factory-websocket-in-module-ngwebsocket" aria-hidden="true"><span class="octicon octicon-link"></span></a>Factory: <code>$websocket</code> (in module <code>ngWebSocket</code>)</h3>

<p>returns instance of $Websocket</p>

<h3>
<a id="methods" class="anchor" href="#methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Methods</h3>

<table>
<thead>
<tr>
<th>name</th>
<th>arguments</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>$websocket <br><em>constructor</em>
</td>
<td>url:String</td>
<td>Creates and opens a <a href="http://mdn.io/API/WebSocket">WebSocket</a> instance. <br><code>var ws = $websocket('ws://foo');</code>
</td>
</tr>
<tr>
<td>send</td>
<td>data:String,Object returns</td>
<td>Adds data to a queue, and attempts to send if socket is ready. Accepts string or object, and will stringify objects before sending to socket.</td>
</tr>
<tr>
<td>onMessage</td>
<td>callback:Function <br>options{filter:String,RegExp, autoApply:Boolean=true}</td>
<td>Register a callback to be fired on every message received from the websocket, or optionally just when the message's <code>data</code> property matches the filter provided in the options object. Each message handled will safely call <code>$rootScope.$digest()</code> unless <code>autoApply</code> is set to `false in the options. Callback gets called with a <a href="https://developer.mozilla.org/en-US/docs/Web/API/MessageEvent?redirectlocale=en-US&amp;redirectslug=WebSockets%2FWebSockets_reference%2FMessageEvent">MessageEvent</a> object.</td>
</tr>
<tr>
<td>onOpen</td>
<td>callback:Function</td>
<td>Function to be executed each time a socket connection is opened for this instance.</td>
</tr>
<tr>
<td>onClose</td>
<td>callback:Function</td>
<td>Function to be executed each time a socket connection is closed for this instance.</td>
</tr>
<tr>
<td>onError</td>
<td>callback:Function</td>
<td>Function to be executed each time a socket connection has an Error for this instance.</td>
</tr>
<tr>
<td>close</td>
<td>force:Boolean:<em>optional</em>
</td>
<td>Close the underlying socket, as long as no data is still being sent from the client. Optionally force close, even if data is still being sent, by passing <code>true</code> as the <code>force</code> parameter. To check if data is being sent, read the value of <code>socket.bufferedAmount</code>.</td>
</tr>
</tbody>
</table>

<h3>
<a id="properties" class="anchor" href="#properties" aria-hidden="true"><span class="octicon octicon-link"></span></a>Properties</h3>

<table>
<thead>
<tr>
<th>name</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>socket</td>
<td>window.WebSocket</td>
<td>
<a href="http://mdn.io/API/WebSocket">WebSocket</a> instance.</td>
</tr>
<tr>
<td>sendQueue</td>
<td>Array</td>
<td>Queue of <code>send</code> calls to be made on socket when socket is able to receive data. List is populated by calls to the <code>send</code> method, but this array can be spliced if data needs to be manually removed before it's been sent to a socket. Data is removed from the array after it's been sent to the socket.</td>
</tr>
<tr>
<td>onOpenCallbacks</td>
<td>Array</td>
<td>List of callbacks to be executed when the socket is opened, initially or on re-connection after broken connection. Callbacks should be added to this list through the <code>onOpen</code> method.</td>
</tr>
<tr>
<td>onMessageCallbacks</td>
<td>Array</td>
<td>List of callbacks to be executed when a message is received from the socket. Callbacks should be added via the <code>onMessage</code> method.</td>
</tr>
<tr>
<td>onErrorCallbacks</td>
<td>Array</td>
<td>List of callbacks to be executed when an error is received from the socket. Callbacks should be added via the <code>onError</code> method.</td>
</tr>
<tr>
<td>onCloseCallbacks</td>
<td>Array</td>
<td>List of callbacks to be executed when the socket is closed. Callbacks should be added via the <code>onClose</code> method.</td>
</tr>
<tr>
<td>readyState</td>
<td>Number:readonly</td>
<td>Returns either the readyState value from the underlying WebSocket instance, or a proprietary value representing the internal state of the lib, e.g. if the lib is in a state of re-connecting.</td>
</tr>
<tr>
<td>initialTimeout</td>
<td>Number</td>
<td>The initial timeout, should be set at the outer limits of expected response time for the service. For example, if your service responds in 1ms on average but in 10ms for 99% of requests, then set to 10ms.</td>
</tr>
<tr>
<td>maxTimeout</td>
<td>Number</td>
<td>Should be as low as possible to keep your customers happy, but high enough that the system can definitely handle requests from all clients at that sustained rate.</td>
</tr>
</tbody>
</table>

<h3>
<a id="cancelablepromise" class="anchor" href="#cancelablepromise" aria-hidden="true"><span class="octicon octicon-link"></span></a>CancelablePromise</h3>

<p>This type is returned from the <code>send()</code> instance method of $websocket, inherits from <a href="https://ng-click.com/%24q">$q.defer().promise</a>.</p>

<h3>
<a id="methods-1" class="anchor" href="#methods-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Methods</h3>

<table>
<thead>
<tr>
<th>name</th>
<th>arguments</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>cancel</td>
<td></td>
<td>Alias to <code>deferred.reject()</code>, allows preventing an unsent message from being sent to socket for any arbitrary reason.</td>
</tr>
<tr>
<td>then</td>
<td>resolve:Function, reject:Function</td>
<td>Resolves when message has been passed to socket, presuming the socket has a <code>readyState</code> of 1. Rejects if the socket is hopelessly disconnected now or in the future (i.e. the library is no longer attempting to reconnect). All messages are immediately rejected when the library has determined that re-establishing a connection is unlikely.</td>
</tr>
</tbody>
</table>

<h3>
<a id="service-websocketbackend-in-module-ngwebsocketmock" class="anchor" href="#service-websocketbackend-in-module-ngwebsocketmock" aria-hidden="true"><span class="octicon octicon-link"></span></a>Service: <code>$websocketBackend</code> (in module <code>ngWebSocketMock</code>)</h3>

<p>Similar to <a href="https://ng-click.com/%24httpBackend"><code>httpBackend</code></a> mock in
AngularJS's <code>ngMock</code> module. You can use <code>ngWebSocketMock</code> to mock a websocket
server in order to test your applications:</p>

<div class="highlight highlight-source-js"><pre>    <span class="pl-k">var</span> $websocketBackend;

    beforeEach(angular.mock.module(<span class="pl-s"><span class="pl-pds">'</span>ngWebSocket<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>ngWebSocketMock<span class="pl-pds">'</span></span>);

    beforeEach(inject(<span class="pl-k">function</span> (<span class="pl-smi">_$websocketBackend_</span>) {
      $websocketBackend <span class="pl-k">=</span> _$websocketBackend_;

      $websocketBackend.mock();
      $websocketBackend.expectConnect(<span class="pl-s"><span class="pl-pds">'</span>ws://localhost:8080/api<span class="pl-pds">'</span></span>);
      $websocketBackend.expectSend({data<span class="pl-k">:</span> <span class="pl-c1">JSON</span>.stringify({test<span class="pl-k">:</span> <span class="pl-c1">true</span>})});
    }));</pre></div>

<h3>
<a id="methods-2" class="anchor" href="#methods-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Methods</h3>

<table>
<thead>
<tr>
<th>name</th>
<th>arguments</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>flush</td>
<td></td>
<td>Executes all pending requests</td>
</tr>
<tr>
<td>expectConnect</td>
<td>url:String</td>
<td>Specify the url of an expected WebSocket connection</td>
</tr>
<tr>
<td>expectClose</td>
<td></td>
<td>Expect "close" to be called on the WebSocket</td>
</tr>
<tr>
<td>expectSend</td>
<td>msg:String</td>
<td>Expectation of send to be called, with required message</td>
</tr>
<tr>
<td>verifyNoOutstandingExpectation</td>
<td></td>
<td>Makes sure all expectations have been satisfied, should be called in afterEach</td>
</tr>
<tr>
<td>verifyNoOutstandingRequest</td>
<td></td>
<td>Makes sure no requests are pending, should be called in afterEach</td>
</tr>
</tbody>
</table>

<h2>
<a id="frequently-asked-questions" class="anchor" href="#frequently-asked-questions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Frequently asked questions</h2>

<ul>
<li>
<em>Q.</em>: What if the browser doesn't support WebSockets?</li>
<li>
<em>A.</em>: This module will not help; it does not have a fallback story for browsers that do not support WebSockets. Please check your browser target support <a href="http://caniuse.com/#feat=websockets">here</a> and to include fallback support.</li>
</ul>

<h2>
<a id="development" class="anchor" href="#development" aria-hidden="true"><span class="octicon octicon-link"></span></a>Development</h2>

<div class="highlight highlight-source-shell"><pre>$ npm install
$ bower install</pre></div>

<h2>
<a id="changelog" class="anchor" href="#changelog" aria-hidden="true"><span class="octicon octicon-link"></span></a>Changelog</h2>

<p><a href="https://github.com/gdi2290/angular-websocket/blob/master/CHANGELOG.md">Changelog</a></p>

<h3>
<a id="unit-tests" class="anchor" href="#unit-tests" aria-hidden="true"><span class="octicon octicon-link"></span></a>Unit Tests</h3>

<p><code>$ npm test</code> Run karma in Chrome, Firefox, and Safari</p>

<h3>
<a id="manual-tests" class="anchor" href="#manual-tests" aria-hidden="true"><span class="octicon octicon-link"></span></a>Manual Tests</h3>

<p>In the project root directory open <code>index.html</code> in the example folder or browserify example</p>

<h3>
<a id="distribute" class="anchor" href="#distribute" aria-hidden="true"><span class="octicon octicon-link"></span></a>Distribute</h3>

<p><code>$ npm run dist</code> Builds files with uglifyjs</p>

<h3>
<a id="support" class="anchor" href="#support" aria-hidden="true"><span class="octicon octicon-link"></span></a>Support</h3>

<p>You can contact me either by: <a href="https://github.com/gdi2290/angular-websocket/issues/new">submitting</a> an issue, <a href="https://twitter.com/share?url=''&amp;text=@gdi2290+I+need+help+with+%E2%80%A6">tweeting me</a> on twitter <a href="https://twitter.com/gdi2290">@gdi2290</a>, or chat me on <a href="https://gitter.im/gdi2290/angular-websocket?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge">gitter</a></p>

<h2>
<a id="todo" class="anchor" href="#todo" aria-hidden="true"><span class="octicon octicon-link"></span></a>TODO</h2>

<ul>
<li>Allow JSON if object is sent</li>
<li>Allow more control over $digest cycle per WebSocket instance</li>
<li>Add Angular interceptors</li>
<li>Add .on(event)</li>
<li>Include more examples of patterns for realtime Angular apps</li>
<li>Allow for optional configuration object in $websocket constructor</li>
<li>Add W3C Websocket support</li>
<li>Add socket.io support</li>
<li>Add SockJS support</li>
<li>Add Faye support</li>
<li>Add PubNub support
___</li>
</ul>

<p>enjoy — <strong>AngularClass</strong> </p>

<p><br><br></p>

<p><a href="https://angularclass.com"><img src="https://cloud.githubusercontent.com/assets/1016365/9863770/cb0620fc-5af7-11e5-89df-d4b0b2cdfc43.png" alt="AngularClass" title="Angular Class"></a></p>

<h2>
<a id="angularclass" class="anchor" href="#angularclass" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://angularclass.com">AngularClass</a>
</h2>

<blockquote>
<p>Learn AngularJS, Angular 2, and Modern Web Development form the best.
Looking for corporate Angular training, want to host us, or Angular consulting? <a href="mailto:patrick@angularclass.com">patrick@angularclass.com</a></p>
</blockquote>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p><a href="https://github.com/gdi2290/angular-websocket/blob/master/LICENSE">MIT</a></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/angular-class/angular-websocket">Angular Websocket</a> is maintained by <a href="https://github.com/angular-class">angular-class</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

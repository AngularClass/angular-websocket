{"version":3,"sources":["src/angular-websocket.js"],"names":["$WebSocketProvider","$rootScope","$q","$timeout","$websocketBackend","$WebSocket","url","protocols","options","isObject","isArray","undefined","this","ssl","test","scope","rootScopeFailover","useApplyAsync","initialTimeout","maxTimeout","reconnectIfNotNormalClose","_reconnectAttempts","sendQueue","onOpenCallbacks","onMessageCallbacks","onErrorCallbacks","onCloseCallbacks","objectFreeze","_readyStateConstants","_connect","_setInternalState","prototype","CONNECTING","OPEN","CLOSING","CLOSED","RECONNECT_ABORTED","_normalCloseCode","_reconnectableStatusCodes","safeDigest","autoApply","$$phase","$digest","bindToScope","self","$on","force","socket","readyState","create","onmessage","angular","bind","_onMessageHandler","onopen","_onOpenHandler","onerror","_onErrorHandler","onclose","_onCloseHandler","fireQueue","length","data","shift","send","isString","message","JSON","stringify","deferred","resolve","notifyOpenCallbacks","event","i","call","notifyCloseCallbacks","notifyErrorCallbacks","onOpen","cb","push","onClose","onError","onMessage","callback","isFunction","Error","isDefined","filter","RegExp","fn","pattern","$applyAsync","code","indexOf","reconnect","applyAsyncOrDigest","args","arraySlice","arguments","apply","currentCallback","exec","close","bufferedAmount","cancelableify","promise","cancel","then","newPromise","reason","splice","reject","defer","isMocked","isConnected","mockSend","value","backoffDelay","_getBackoffDelay","backoffDelaySeconds","console","log","attempt","R","Math","random","T","F","N","M","floor","min","pow","state","objectDefineProperty","_internalConnectionState","forEach","pending","get","set","$WebSocketBackendProvider","$window","$log","Socket","ws","match","exports","require","Client","client","e","WebSocket","MozWebSocket","createWebSocketBackend","warn","noop","Object","freeze","defineProperty","Array","slice","elt","len","from","Number","ceil","module","factory","service","define"],"mappings":"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"}